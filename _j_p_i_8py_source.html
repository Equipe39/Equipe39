<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PolyBM: src/JPI.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="LGS.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">PolyBM<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">The PolyBM Data Analysis Tool is an AI tool that helps users profile, format, and anonymize data from CSV, JSON, and XML files. The tool offers various functionalities such as creating charts, generating data quality reports, and anonymizing sensitive data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_j_p_i_8py_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">JPI.py</div></div>
</div><!--header-->
<div class="contents">
<a href="_j_p_i_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html">    1</a></span><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="stringliteral">Author : RaphaÃ«l Lasalle</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="stringliteral">Date : 06-03-2023</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">import</span> subprocess <span class="keyword">as</span> sp</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="keyword">import</span> random</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="keyword">import</span> math</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="keyword">import</span> json</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="keyword">import</span> pika <span class="keyword">as</span> pk</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="keyword">import</span> time</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="keyword">import</span> threading</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a75e4b8a98badafbe9849b9bfaa2d234a">   16</a></span>DEFAULT_SAMPLE_SIZE = 0.1</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#ac3e80486cf9ce4869e5aa88863a5f060">   17</a></span>ENCODING = <span class="stringliteral">&quot;UTF-8&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">#key constants for parsing rabbitmq config file</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#af26f2c8225b90c49e3d37e4f1e1e8d32">   20</a></span>CONFIG_FILE_PATH = <span class="stringliteral">&quot;config/python_rmq_config.json&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a19a8a948dff96f470db49cc6e4b91890">   21</a></span>USER_KEY = <span class="stringliteral">&quot;user&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#af650880aa76ec8eaa6c7a4613c718966">   22</a></span>PSWD_KEY = <span class="stringliteral">&quot;pswd&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a5a828618a018d49b181f9a3373ccc55a">   23</a></span>HOST_KEY = <span class="stringliteral">&quot;host&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a49e232a3e66800640910e2da5beb442c">   24</a></span>PORT_KEY = <span class="stringliteral">&quot;port&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a7e667834392bea2ca49a6355609055d6">   25</a></span>EXCH_NAME_KEY = <span class="stringliteral">&quot;exchange_name&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a3920a1892ef6d7d11c89cb834e5cd6d1">   26</a></span>EXCH_TYPE_KEY = <span class="stringliteral">&quot;exchange_type&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a735ab48614177813c8eae75b821a254c">   27</a></span>Q_KEY  = <span class="stringliteral">&quot;queues&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a1f2d023f59db75619be60a1ebdcb3843">   28</a></span>TIQ = <span class="stringliteral">&quot;python_type_id_queue&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a2f89543e170bc0c0c7cdfddd29d11016">   29</a></span>VIQ = <span class="stringliteral">&quot;python_vuln_id_queue&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a60d5271ce6c8b6ecbafa66d4224671c5">   30</a></span>JAVA_TIQ_RTK = <span class="stringliteral">&quot;java_type_id&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#acec2e42870efa82664cb972bb666f68a">   31</a></span>JAVA_VIQ_RTK = <span class="stringliteral">&quot;java_vuln_id&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a2dd0e495fc28f0102f277edbda0eed4c">   32</a></span>PYTHON_TIQ_RTK = <span class="stringliteral">&quot;python_type_id&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a74b37a10648ff4c82701329ab6bf1bb2">   33</a></span>PYTHON_VIQ_RTK = <span class="stringliteral">&quot;python_vuln_id&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a68111823005196a24dc8e50b4ef5c4b5">   34</a></span>Q_NAME_KEY = <span class="stringliteral">&quot;queue_name&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a8ecd256caf08098ff56769906dccb394">   35</a></span>RTK_KEY = <span class="stringliteral">&quot;routing_key&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#aa89e8de38cd2717c71602d52b3cccb28">   36</a></span>DRBL_KEY = <span class="stringliteral">&quot;durable&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a0a58eead4e3823ee82e382046ecc49ca">   37</a></span>EXCL_KEY = <span class="stringliteral">&quot;exclusive&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a038d01f3876814dfb066b433434bba99">   38</a></span>AUT_DEL_KEY = <span class="stringliteral">&quot;auto_del&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#adf73036a594865e8e3db4a6ef1849420">   39</a></span>Q_ARGS_KEY = <span class="stringliteral">&quot;queue_args&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="namespace_j_p_i.html#a343173488732b3d5268e6164c57f9c26">   41</a></span>V_HOST = <span class="stringliteral">&quot;/&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html">   43</a></span><span class="keyword">class </span><a class="code hl_class" href="class_j_p_i_1_1_j_p_i.html">JPI</a>:</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a23fbb23b0aab9fe7f84919b34a26ebab">   45</a></span>    <span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a23fbb23b0aab9fe7f84919b34a26ebab">__init__</a>(self) -&gt; None:</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="stringliteral">         </span><span class="preprocessor">@brief</span> Initializes JPI. Initializes connection credentials <span class="keywordflow">and</span> connection parameters. This method <span class="keywordflow">is</span> called by __init__ method of <span class="keyword">class</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="stringliteral">        </span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="stringliteral">        </span><span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>            print(<span class="stringliteral">&quot;starting JPI init !&quot;</span>)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a938860f684e67e9d9a45de27d494335f">   52</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a938860f684e67e9d9a45de27d494335f">config_file</a> = open(CONFIG_FILE_PATH)</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">   53</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a> = json.load(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a938860f684e67e9d9a45de27d494335f">config_file</a>)</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a38bb7304fd64b53d51be699dbc8edf5d">   55</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a38bb7304fd64b53d51be699dbc8edf5d">rabbitmq_username</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[USER_KEY]</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a4827a35936f9cace1f011bcb7206af56">   56</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a4827a35936f9cace1f011bcb7206af56">rabbitmq_password</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[PSWD_KEY]</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a1e591ef6c3871779416f888e77ba59c0">   57</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a1e591ef6c3871779416f888e77ba59c0">rabbitmq_host</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[HOST_KEY]</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a1dccc2ae34ec9f0845c1d3cfd793747c">   58</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a1dccc2ae34ec9f0845c1d3cfd793747c">rabbitmq_port</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[PORT_KEY]</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a09b931967f997fe53cb2baafb5a80a76">   60</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a09b931967f997fe53cb2baafb5a80a76">rabbitmq_exchange_name</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[EXCH_NAME_KEY]</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a1aa3aaac57090094fcbbe0366de2e659">   61</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a1aa3aaac57090094fcbbe0366de2e659">rabbitmq_exchange_type</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[EXCH_TYPE_KEY]</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#ae082541106538f02d1abfca8a3a3b285">   63</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#ae082541106538f02d1abfca8a3a3b285">queues</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[Q_KEY]</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a9539f88e9de360be88e2ad1bca0086e8">   64</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a9539f88e9de360be88e2ad1bca0086e8">connection_credentials</a> = pk.PlainCredentials(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a38bb7304fd64b53d51be699dbc8edf5d">rabbitmq_username</a>,self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a4827a35936f9cace1f011bcb7206af56">rabbitmq_password</a>)</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#aee24e8790819b5640535e11c4c4db912">   65</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#aee24e8790819b5640535e11c4c4db912">connection_param</a> = pk.ConnectionParameters(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a1e591ef6c3871779416f888e77ba59c0">rabbitmq_host</a>,self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a1dccc2ae34ec9f0845c1d3cfd793747c">rabbitmq_port</a>,V_HOST,self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a9539f88e9de360be88e2ad1bca0086e8">connection_credentials</a>)</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a66b0a43c3aec54b3c41b921c1fc4c951">   67</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a66b0a43c3aec54b3c41b921c1fc4c951">data_types</a> = []</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a4bdf5e5ba75b051c5cf2323ac3bb3a79">   68</a></span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a4bdf5e5ba75b051c5cf2323ac3bb3a79">vulnerabilities</a> = []</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a3fd152653ad65db4285006c7df63427e">   71</a></span>                self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a3fd152653ad65db4285006c7df63427e">connection</a> = pk.BlockingConnection(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#aee24e8790819b5640535e11c4c4db912">connection_param</a>)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">   72</a></span>                self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a3fd152653ad65db4285006c7df63427e">connection</a>.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>()</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a4b797fc224d6f0bd807a698a043bbfa3">   73</a></span>                self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a4b797fc224d6f0bd807a698a043bbfa3">exchange</a> = self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.exchange_declare(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a09b931967f997fe53cb2baafb5a80a76">rabbitmq_exchange_name</a>,self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a1aa3aaac57090094fcbbe0366de2e659">rabbitmq_exchange_type</a>)</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>                <span class="comment"># declare durable exclusive auto_delete arguments and arguments</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>                <span class="keywordflow">for</span> queue <span class="keywordflow">in</span> self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#ae082541106538f02d1abfca8a3a3b285">queues</a>:</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>                    </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>                    self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.queue_declare(</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>                        str(queue[Q_NAME_KEY]),</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>                        durable=bool(queue[DRBL_KEY]),</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                        exclusive=bool(queue[EXCL_KEY]),</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                        auto_delete=bool(queue[AUT_DEL_KEY]),</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>                        arguments=queue[Q_ARGS_KEY]</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>                    )</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>                    self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.queue_bind(</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>                        str(queue[Q_NAME_KEY]),</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>                        str(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">config_data</a>[EXCH_NAME_KEY]),</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                        str(queue[RTK_KEY])</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                    )</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>                </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                    </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            <span class="keywordflow">except</span> pk.exceptions.AMQPConnectionError <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>                st.error(<span class="stringliteral">&quot;could not connect to rabbitmq server !&quot;</span>)</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="keywordflow">except</span> FileNotFoundError <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            st.error(<span class="stringliteral">&quot;config file not found !&quot;</span>)</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="keywordflow">except</span> json.JSONDecodeError <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>            st.error(<span class="stringliteral">&quot;config file could not be read !&quot;</span>)</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a08f5feb0dc2c6a4644082e2179a502b2">  103</a></span>    <span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a08f5feb0dc2c6a4644082e2179a502b2">__enter__</a>(self):</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="stringliteral">         </span><span class="preprocessor">@brief</span> Return self to allow __enter__ to be called multiple times. This <span class="keywordflow">is</span> useful <span class="keywordflow">for</span> debugging the code that calls __enter__ <span class="keywordflow">in</span> a context manager.</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>         <span class="preprocessor">@return</span> self to allow __enter__ to be called multiple times <span class="keywordflow">in</span> a context manager. Note that __enter__ does <span class="keywordflow">not</span> have to be called when you<span class="stringliteral">&#39;re inside a context</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="stringliteral">        </span><span class="keywordflow">return</span> self</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a5a21985b0fc0dc01a9c56f276f1c8f63">  110</a></span>    <span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a5a21985b0fc0dc01a9c56f276f1c8f63">__exit__</a>(self, exc_type, exc_val, exc_tb):</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="stringliteral">         </span><span class="preprocessor">@brief</span> Called when exception <span class="keywordflow">is</span> raised. Closes the connection <span class="keywordflow">if</span> it<span class="stringliteral">&#39;s open. This is a no - op if the connection isn&#39;</span>t open.</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>         <span class="preprocessor">@param</span> exc_type The type of exception raised. Ignored.</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>         <span class="preprocessor">@param</span> exc_val The value of the exception raised. Ignored</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>         <span class="preprocessor">@param</span> exc_tb</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="stringliteral">        </span><span class="comment"># Closes the connection to the server.</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a3fd152653ad65db4285006c7df63427e">connection</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a3fd152653ad65db4285006c7df63427e">connection</a>.close()</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#ac22e64f6eddefc8bfb7515ff539661f3">  121</a></span>    <span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#ac22e64f6eddefc8bfb7515ff539661f3">send</a>(self,message:str,routing_key:str,reply_queue:str):</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="stringliteral">         </span><span class="preprocessor">@brief</span> Send a message to RabbitMQ <span class="keywordflow">and</span> consume the reply queue. This <span class="keywordflow">is</span> a low - level method to be used by subclasses that want to send messages to RabbitMQ without having to re - use the AMQP protocol.</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>         <span class="preprocessor">@param</span> message The message to be sent. It should be a string <span class="keywordflow">in</span> the format <span class="stringliteral">&quot; message. text &quot;</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>         <span class="preprocessor">@param</span> routing_key The routing key <span class="keywordflow">for</span> the message.</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>         <span class="preprocessor">@param</span> reply_queue The queue to consume the reply <span class="keyword">from</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span><span class="stringliteral">        self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.basic_publish(self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a09b931967f997fe53cb2baafb5a80a76">rabbitmq_exchange_name</a>,routing_key,message)</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="stringliteral">        self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.basic_consume(reply_queue,on_message_callback=self.<a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a9dec851c31c0d8abac6e9c651e2d8582">handle_delivery</a>,auto_ack=</span><span class="keyword">True</span>)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.start_consuming()</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a9dec851c31c0d8abac6e9c651e2d8582">  132</a></span>    <span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a9dec851c31c0d8abac6e9c651e2d8582">handle_delivery</a>(self,ch, method, properties, body):</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>       <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="stringliteral">        </span><span class="preprocessor">@brief</span> Called when RabbitMQ has received a message. We need to update our data types <span class="keywordflow">and</span> vulnerabilities</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        <span class="preprocessor">@param</span> ch Channel that sent the message</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        <span class="preprocessor">@param</span> method Message method that was sent to RabbitMQ ( <span class="keywordflow">not</span> used )</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        <span class="preprocessor">@param</span> properties Properties associated <span class="keyword">with</span> the message ( <span class="keywordflow">not</span> used )</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        <span class="preprocessor">@param</span> body Message body ( unencoded JSON string ) This method <span class="keywordflow">is</span> responsible <span class="keywordflow">for</span> parsing the message</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>       <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="stringliteral">       </span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span><span class="stringliteral">       json_data = body.decode(ENCODING)</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span><span class="stringliteral">       routing_key = method.routing_key </span><span class="comment">#check syntax when internet is back</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>       <span class="comment"># Load the data types and vulnerabilities from the data_types and vulnerabilities.</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>       <span class="keywordflow">if</span> routing_key == PYTHON_TIQ_RTK:</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>           self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a66b0a43c3aec54b3c41b921c1fc4c951">data_types</a> = json.loads(json_data)</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>       <span class="keywordflow">elif</span> routing_key == PYTHON_VIQ_RTK:</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>           self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a4bdf5e5ba75b051c5cf2323ac3bb3a79">vulnerabilities</a> = json.loads(json_data)</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>       self.<a class="code hl_variable" href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">channel</a>.stop_consuming()</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="stringliteral">    Selects a randomly distributed sample of the provided dataset to identify </span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="stringliteral">    the predominant semantic type. </span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="stringliteral">    </span><span class="preprocessor">@param</span> data : the source dataset</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="preprocessor">@param</span> sample_size_ratio : size of the selected sample expressed <span class="keyword">as</span> a percentage of the total dataset.</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        must be a number between 0 <span class="keywordflow">and</span> 1</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="preprocessor">@return</span> : the predominant semantic type of each column of the dataset</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a3688f5930bd7357389b6531c9f27682b">  161</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a3688f5930bd7357389b6531c9f27682b">identify_type</a>(self,df:pd.DataFrame,sample_size:float=DEFAULT_SAMPLE_SIZE) -&gt; str:</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="stringliteral">         </span><span class="preprocessor">@brief</span> Identify type of data. This <span class="keywordflow">is</span> a method to use when you want to send data to TIQ <span class="keywordflow">and</span> get a string that can be used <span class="keyword">as</span> a type identifier.</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>         <span class="preprocessor">@param</span> df Dataframe <span class="keyword">with</span> columns <span class="keywordflow">and</span> values to be sent</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>         <span class="preprocessor">@param</span> sample_size Number of samples to send per time step</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>         <span class="preprocessor">@return</span> JSON string of type identifier ( RTK / IDQ ) <span class="keywordflow">for</span> the data <span class="keywordflow">in</span> the DataFrame <span class="keywordflow">and</span> the</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span><span class="stringliteral">        samples = []</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="stringliteral">        effective_sample_size = math.ceil(len(df) * sample_size)</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="stringliteral">        </span><span class="comment"># Generate a sample of the columns in the dataframe.</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <span class="keywordflow">for</span> column <span class="keywordflow">in</span> df.columns:</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>            sample = []</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            random_indices = random.sample(range(len(df)),effective_sample_size)</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            <span class="comment"># Generate a sample of random indices.</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>            <span class="keywordflow">for</span> index <span class="keywordflow">in</span> random_indices:</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                sample.append(str(df.loc[index,column]))</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>            samples.append(sample)</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        json_samples = json.dumps(samples)</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        self.<a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#ac22e64f6eddefc8bfb7515ff539661f3">send</a>(json_samples,JAVA_TIQ_RTK,TIQ)</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="stringliteral">    Identifies the vulnerabilities </span><span class="keywordflow">in</span> a dataset by finding potential identifiers <span class="keywordflow">and</span> quasi-identifiers.</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    Makes a call to the data-privacy-toolkit library. </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="preprocessor">@param</span> n_trhreads : the number of threads used to run the algorithm</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="preprocessor">@param</span> uniqueness_threshold : the k value used to check the frequency of a value against. If a value appears less times than the </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        threshold, the corresponding fied will be flagged <span class="keyword">as</span> a vulnerability (identifier <span class="keywordflow">or</span> quasi-identifier)</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="preprocessor">@param</span> data : the source dataset</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="preprocessor">@return</span> : the indices of the vulnerable columns <span class="keyword">as</span> a list of int (single indices <span class="keywordflow">for</span> identifiers <span class="keywordflow">and</span> nested list <span class="keywordflow">for</span> quasi-identifiers)</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno"><a class="line" href="class_j_p_i_1_1_j_p_i.html#a2b2fa9e319156829de39104fc701fef5">  193</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#a2b2fa9e319156829de39104fc701fef5">identify_vulnerabilities</a>(self,df:pd.DataFrame,k_value:int,n_threads:int) -&gt; list:</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="stringliteral">         </span><span class="preprocessor">@brief</span> Identify vulnerabilities by sending a message to the Java Vulnerability Queue. This <span class="keywordflow">is</span> a low - level method that should be used <span class="keywordflow">in</span> conjunction <span class="keyword">with</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>         <span class="preprocessor">@param</span> df DataFrame containing data to analyze</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>         <span class="preprocessor">@param</span> k_value Number of k - values to use</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>         <span class="preprocessor">@param</span> n_threads Number of threads to use <span class="keywordflow">for</span> the analysis</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>         <span class="preprocessor">@return</span> A list of dictionaries that contain the following keys : data : A Pandas DataFrame that can be converted to a list</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="stringliteral">        df_rows = []</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span><span class="stringliteral">        </span><span class="comment"># Append all rows in the dataframe to the dataframe.</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <span class="keywordflow">for</span> index,row <span class="keywordflow">in</span> df.iterrows():</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            df_rows.append(row.to_list())</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        payload = {</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>            <span class="stringliteral">&quot;data&quot;</span>:df_rows,</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <span class="stringliteral">&quot;k_value&quot;</span>:k_value,</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            <span class="stringliteral">&quot;n_threads&quot;</span>:n_threads</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        json_message = json.dumps(payload)</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        self.<a class="code hl_function" href="class_j_p_i_1_1_j_p_i.html#ac22e64f6eddefc8bfb7515ff539661f3">send</a>(json_message,JAVA_VIQ_RTK,VIQ)</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    </div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html">JPI.JPI</a></div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00043">JPI.py:43</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a08f5feb0dc2c6a4644082e2179a502b2"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a08f5feb0dc2c6a4644082e2179a502b2">JPI.JPI.__enter__</a></div><div class="ttdeci">def __enter__(self)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00103">JPI.py:103</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a09b931967f997fe53cb2baafb5a80a76"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a09b931967f997fe53cb2baafb5a80a76">JPI.JPI.rabbitmq_exchange_name</a></div><div class="ttdeci">rabbitmq_exchange_name</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00060">JPI.py:60</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a1aa3aaac57090094fcbbe0366de2e659"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a1aa3aaac57090094fcbbe0366de2e659">JPI.JPI.rabbitmq_exchange_type</a></div><div class="ttdeci">rabbitmq_exchange_type</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00061">JPI.py:61</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a1dccc2ae34ec9f0845c1d3cfd793747c"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a1dccc2ae34ec9f0845c1d3cfd793747c">JPI.JPI.rabbitmq_port</a></div><div class="ttdeci">rabbitmq_port</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00058">JPI.py:58</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a1e591ef6c3871779416f888e77ba59c0"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a1e591ef6c3871779416f888e77ba59c0">JPI.JPI.rabbitmq_host</a></div><div class="ttdeci">rabbitmq_host</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00057">JPI.py:57</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a23fbb23b0aab9fe7f84919b34a26ebab"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a23fbb23b0aab9fe7f84919b34a26ebab">JPI.JPI.__init__</a></div><div class="ttdeci">None __init__(self)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00045">JPI.py:45</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a274c641cdf166a54715eccbe5c3da836"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a274c641cdf166a54715eccbe5c3da836">JPI.JPI.config_data</a></div><div class="ttdeci">config_data</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00053">JPI.py:53</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a2b2fa9e319156829de39104fc701fef5"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a2b2fa9e319156829de39104fc701fef5">JPI.JPI.identify_vulnerabilities</a></div><div class="ttdeci">list identify_vulnerabilities(self, pd.DataFrame df, int k_value, int n_threads)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00193">JPI.py:193</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a3688f5930bd7357389b6531c9f27682b"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a3688f5930bd7357389b6531c9f27682b">JPI.JPI.identify_type</a></div><div class="ttdeci">str identify_type(self, pd.DataFrame df, float sample_size=DEFAULT_SAMPLE_SIZE)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00161">JPI.py:161</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a38bb7304fd64b53d51be699dbc8edf5d"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a38bb7304fd64b53d51be699dbc8edf5d">JPI.JPI.rabbitmq_username</a></div><div class="ttdeci">rabbitmq_username</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00055">JPI.py:55</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a3fd152653ad65db4285006c7df63427e"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a3fd152653ad65db4285006c7df63427e">JPI.JPI.connection</a></div><div class="ttdeci">connection</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00071">JPI.py:71</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a4827a35936f9cace1f011bcb7206af56"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a4827a35936f9cace1f011bcb7206af56">JPI.JPI.rabbitmq_password</a></div><div class="ttdeci">rabbitmq_password</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00056">JPI.py:56</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a498813010a86ce4db71c5bfa05fc93b5"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a498813010a86ce4db71c5bfa05fc93b5">JPI.JPI.channel</a></div><div class="ttdeci">channel</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00072">JPI.py:72</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a4b797fc224d6f0bd807a698a043bbfa3"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a4b797fc224d6f0bd807a698a043bbfa3">JPI.JPI.exchange</a></div><div class="ttdeci">exchange</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00073">JPI.py:73</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a4bdf5e5ba75b051c5cf2323ac3bb3a79"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a4bdf5e5ba75b051c5cf2323ac3bb3a79">JPI.JPI.vulnerabilities</a></div><div class="ttdeci">vulnerabilities</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00068">JPI.py:68</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a5a21985b0fc0dc01a9c56f276f1c8f63"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a5a21985b0fc0dc01a9c56f276f1c8f63">JPI.JPI.__exit__</a></div><div class="ttdeci">def __exit__(self, exc_type, exc_val, exc_tb)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00110">JPI.py:110</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a66b0a43c3aec54b3c41b921c1fc4c951"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a66b0a43c3aec54b3c41b921c1fc4c951">JPI.JPI.data_types</a></div><div class="ttdeci">data_types</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00067">JPI.py:67</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a938860f684e67e9d9a45de27d494335f"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a938860f684e67e9d9a45de27d494335f">JPI.JPI.config_file</a></div><div class="ttdeci">config_file</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00052">JPI.py:52</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a9539f88e9de360be88e2ad1bca0086e8"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a9539f88e9de360be88e2ad1bca0086e8">JPI.JPI.connection_credentials</a></div><div class="ttdeci">connection_credentials</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00064">JPI.py:64</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_a9dec851c31c0d8abac6e9c651e2d8582"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#a9dec851c31c0d8abac6e9c651e2d8582">JPI.JPI.handle_delivery</a></div><div class="ttdeci">def handle_delivery(self, ch, method, properties, body)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00132">JPI.py:132</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_ac22e64f6eddefc8bfb7515ff539661f3"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#ac22e64f6eddefc8bfb7515ff539661f3">JPI.JPI.send</a></div><div class="ttdeci">def send(self, str message, str routing_key, str reply_queue)</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00121">JPI.py:121</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_ae082541106538f02d1abfca8a3a3b285"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#ae082541106538f02d1abfca8a3a3b285">JPI.JPI.queues</a></div><div class="ttdeci">queues</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00063">JPI.py:63</a></div></div>
<div class="ttc" id="aclass_j_p_i_1_1_j_p_i_html_aee24e8790819b5640535e11c4c4db912"><div class="ttname"><a href="class_j_p_i_1_1_j_p_i.html#aee24e8790819b5640535e11c4c4db912">JPI.JPI.connection_param</a></div><div class="ttdeci">connection_param</div><div class="ttdef"><b>Definition:</b> <a href="_j_p_i_8py_source.html#l00065">JPI.py:65</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_j_p_i_8py.html">JPI.py</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>

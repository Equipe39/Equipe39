<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PolyBM: pages/6_ðŸ”’_Anonymization.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="LGS.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">PolyBM<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">The PolyBM Data Analysis Tool is an AI tool that helps users profile, format, and anonymize data from CSV, JSON, and XML files. The tool offers various functionalities such as creating charts, generating data quality reports, and anonymizing sensitive data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_208d2690607c4e3d3fabfa1d18673d36.html">pages</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">6_ðŸ”’_Anonymization.py</div></div>
</div><!--header-->
<div class="contents">
<a href="6___xF0_x9F_x94_x92___anonymization_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html">    1</a></span><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="keyword">import</span> src.JPI</div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="keyword">from</span> src.diffPrivacy.DPMechFactory <span class="keyword">import</span> DPMechFactory</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="keyword">from</span> src.masking.maskingFactory <span class="keyword">import</span> MaskingFactory</div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">from</span> src.encryption <span class="keyword">import</span> Encryption</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">from</span> src.tokenization <span class="keyword">import</span> Tokenizer</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keyword">from</span> st_aggrid <span class="keyword">import</span> AgGrid, GridOptionsBuilder, JsCode</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"># Anonymization page layout</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a291fbbf48bc0ac95f185c0b834828236">   11</a></span>st.set_page_config(layout=<span class="stringliteral">&quot;wide&quot;</span>)</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>st.title(<span class="stringliteral">&quot;Anonymization&quot;</span>)</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>st.markdown(<span class="stringliteral">&quot;***&quot;</span>)</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a69bd3a1894e9de6217d3ce288dec67a8">   15</a></span><span class="keyword">def </span><a class="code hl_function" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a69bd3a1894e9de6217d3ce288dec67a8">applyMech</a>(col_to_anonymize):</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="stringliteral">     </span><span class="preprocessor">@brief</span> Applies mech to a column. This <span class="keywordflow">is</span> a wrapper around apply_mech to catch errors that are raised when Epsilon <span class="keywordflow">and</span> Delta are zero</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>     <span class="preprocessor">@param</span> col_to_anonymize name of column to</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="stringliteral">    </span><span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>        mech.apply_mech(col_to_anonymize)</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>        st.session_state[<span class="stringliteral">&#39;selected_columns&#39;</span>] = col_to_anonymize</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>        st.error(<span class="stringliteral">&quot;Epsilon and Delta cannot both be zero | Lower bound must not be greater than upper bound&quot;</span>)   </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>        st.error(<span class="stringliteral">&quot;Epsilon and Delta cannot both be zero | Lower bound must not be greater than upper bound&quot;</span>)         </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        st.error(<span class="stringliteral">&quot;Epsilon and Delta cannot both be zero | Lower bound must not be greater than upper bound&quot;</span>)</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a0b80f1c6e8300057115176c5fe13592a">   30</a></span><span class="keyword">def </span><a class="code hl_function" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a0b80f1c6e8300057115176c5fe13592a">get_vuln_cols</a>(vulnerabilities):</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="stringliteral">     </span><span class="preprocessor">@brief</span> Get vulnerabilities <span class="keyword">from</span> anonymize. This <span class="keywordflow">is</span> a helper function to get the quasi - identifiers <span class="keywordflow">and</span> identifiers <span class="keywordflow">for</span> a list of vulnerabilities</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>     <span class="preprocessor">@param</span> vulnerabilities a list of vulnerabilities</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>     <span class="preprocessor">@return</span> a tuple of two lists : 1</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="stringliteral">    identifiers = []</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="stringliteral">    quasi_identifiers = []</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="stringliteral">    </span><span class="comment"># Add quasi identifiers to identifiers.</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="keywordflow">for</span> col <span class="keywordflow">in</span> vulnerabilities:</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>        <span class="comment"># Add identifiers to identifiers.</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>        <span class="keywordflow">if</span> len(col) &gt; 1:</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>            q = []</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>            <span class="comment"># appends the columns to the query</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> col:</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>                q.append(st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].columns[i])</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>            quasi_identifiers.append(<span class="stringliteral">&#39;, &#39;</span>.join(q))</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            identifiers.append(st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].columns[col[0]])</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keywordflow">return</span> identifiers, quasi_identifiers</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment"># Verify if the file is uploaded</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment"># This function is used to select the data to be uploaded.</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keywordflow">if</span> <span class="stringliteral">&#39;df_anonymize&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> st.session_state:</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    st.warning(<span class="stringliteral">&#39;Please go back to the Upload page and select the data.&#39;</span>)</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a7c56afbbbaacbb7a9f0596b50fc52df0">   55</a></span><span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a60ffc03bb0afa476d3e04518caa47900">   56</a></span>    submit_button = <span class="stringliteral">&#39;submit_button&#39;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#ac300986f0c1ec4c9bcb679335937e592">   57</a></span>    col_a, col_b, col_f = st.columns(3)</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a3175bf4cc5e6afe9e8b7fb1bf9069215">   58</a></span>    mech = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keyword">with</span> col_a:</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        st.subheader(<span class="stringliteral">&quot;Method selection&quot;</span>)</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        <span class="comment"># Anonymization type selection</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a26d103b2f3e5e700ee56ec8b315874b2">   62</a></span>        anonymization_type = st.selectbox(<span class="stringliteral">&quot;Anonymization type&quot;</span>, (<span class="stringliteral">&#39;Differential privacy&#39;</span>, <span class="stringliteral">&#39;Masking&#39;</span>, <span class="stringliteral">&#39;Tokenization and Encryption&#39;</span>))</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        <span class="comment"># Mechanism selection</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        <span class="comment"># The anonymization type is one of the following two types Diffential privacy Masking Masking Tokenization Encryption Encryption Fernet</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        <span class="keywordflow">if</span> anonymization_type == <span class="stringliteral">&#39;Differential privacy&#39;</span>:</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a2e9ac12c8a1c3b3dabff2c95c298658e">   67</a></span>            dp_mech = st.selectbox(<span class="stringliteral">&quot;Differential privacy mechanism&quot;</span>, (<span class="stringliteral">&#39;Geometric truncated&#39;</span>, <span class="stringliteral">&#39;Exponential&#39;</span>, <span class="stringliteral">&#39;Gaussian&#39;</span>, <span class="stringliteral">&#39;Laplace&#39;</span>, <span class="stringliteral">&#39;Snapping&#39;</span>, <span class="stringliteral">&#39;Staircase&#39;</span>, <span class="stringliteral">&#39;Uniform&#39;</span>))</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>            mech = <a class="code hl_namespace" href="namespace_d_p_mech_factory.html">DPMechFactory</a>().create_mechanism(dp_mech)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#aee885e20936a5129253971dc72184db5">   69</a></span>            col_to_anonymize = st.multiselect(<span class="stringliteral">&quot;Columns to anonymize&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].select_dtypes(include=[<span class="stringliteral">&#39;float&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>]).columns)</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        <span class="keywordflow">elif</span> anonymization_type == <span class="stringliteral">&#39;Masking&#39;</span>:</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>            dp_mech = st.selectbox(<span class="stringliteral">&quot;Masking mechanism&quot;</span>, (<span class="stringliteral">&#39;Binning&#39;</span>,<span class="stringliteral">&#39;Generalization&#39;</span>, <span class="stringliteral">&#39;Prefix preservation&#39;</span>, <span class="stringliteral">&#39;Date or time&#39;</span>, <span class="stringliteral">&#39;Shifting&#39;</span>))</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>            mech = MaskingFactory().create_mechanism(dp_mech)</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            <span class="comment"># Select columns to anonymize for the current session state</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            if(dp_mech == <span class="stringliteral">&#39;Binning&#39;</span>):</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>                col_to_anonymize = st.multiselect(<span class="stringliteral">&quot;Columns to anonymize&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].select_dtypes(include=[<span class="stringliteral">&#39;float&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>]).columns)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <span class="keywordflow">elif</span> (dp_mech == <span class="stringliteral">&#39;Date or time&#39;</span>):</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#ad2fdac19c24a2cb55faa0594fb5fbb22">   78</a></span>                date_cols = [col <span class="keywordflow">for</span> col <span class="keywordflow">in</span> st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;date&#39;</span> <span class="keywordflow">in</span> col.lower()]</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>                col_to_anonymize = st.multiselect(<span class="stringliteral">&quot;Columns to anonymize&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>][date_cols].columns)</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                col_to_anonymize = st.multiselect(<span class="stringliteral">&quot;Columns to anonymize&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].columns)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        <span class="keywordflow">elif</span> anonymization_type == <span class="stringliteral">&#39;Tokenization and Encryption&#39;</span>:</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            dp_mech = st.selectbox(<span class="stringliteral">&quot;Chose mechanism&quot;</span>, (<span class="stringliteral">&#39;Tokenization&#39;</span>, <span class="stringliteral">&#39;Encryption (Fernet)&#39;</span>))</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            <span class="comment"># This function is used to perform the encryption and tokenization operations.</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            <span class="keywordflow">if</span> dp_mech == <span class="stringliteral">&#39;Encryption (Fernet)&#39;</span>:</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a742136a34a5f2e042392bb05d019d0a9">   87</a></span>                encryption = Encryption()</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a5ec1c74931c59ab5973e86d17104cddf">   88</a></span>                operation = st.selectbox(<span class="stringliteral">&quot;Chose operation to perform&quot;</span>, (<span class="stringliteral">&#39;Encrypt&#39;</span>, <span class="stringliteral">&#39;Decrypt&#39;</span>))</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                col_to_anonymize = st.multiselect(<span class="stringliteral">&quot;Columns to anonymize&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].columns)</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                <span class="comment"># Decrypt Encrypt Encrypt Encrypt Encrypt Encrypt Encrypt Encrypt Encrypt Encrypt Encrypt</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                <span class="keywordflow">if</span> operation == <span class="stringliteral">&#39;Decrypt&#39;</span> :</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>                    encryption.decrypt(col_to_anonymize)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                <span class="keywordflow">elif</span> operation == <span class="stringliteral">&#39;Encrypt&#39;</span>:</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>                    encryption.encrypt(col_to_anonymize)</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#ac9d72e3034cb0d395c24e4de6d152fb7">   96</a></span>                tokenization = Tokenizer()</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>                operation = st.selectbox(<span class="stringliteral">&quot;Chose operation to perform&quot;</span>, (<span class="stringliteral">&#39;Tokenize&#39;</span>, <span class="stringliteral">&#39;Retrive&#39;</span>))</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                col_to_anonymize = st.multiselect(<span class="stringliteral">&quot;Columns to anonymize&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].columns)</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                <span class="comment"># Tokenize Retrive Retrive Tokenize Retrive Retrive Tokenize Retrive</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                <span class="keywordflow">if</span> operation == <span class="stringliteral">&#39;Tokenize&#39;</span>:</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>                    tokenization.tokenize(col_to_anonymize)</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                <span class="keywordflow">elif</span> operation == <span class="stringliteral">&#39;Retrive&#39;</span>:</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                    tokenization.de_tokenize(col_to_anonymize)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>        <span class="comment"># Add anonymization button to the table</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        <span class="keywordflow">if</span> col_to_anonymize:</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            st.markdown(<span class="stringliteral">&quot;***&quot;</span>)</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#abfc64651c1df47f86bf8f60fdb9b3571">  110</a></span>            space_1, col, space_2 = st.columns((6, 4, 4))</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>            <span class="keyword">with</span> col:</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                <span class="comment"># Add anonymization button to the Anonymization button</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                <span class="keywordflow">if</span> anonymization_type == <span class="stringliteral">&#39;Differential privacy&#39;</span>:</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                <span class="comment"># Anonymization button</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                    submit_button = st.button(label=<span class="stringliteral">&#39;Anonymize&#39;</span>, type=<span class="stringliteral">&quot;primary&quot;</span>, on_click=applyMech, args=(col_to_anonymize,))</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            st.warning(<span class="stringliteral">&#39;Please select at least one column to anonymize&#39;</span>)</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <span class="keyword">with</span> col_b:</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        <span class="comment"># Create a form for the method parameters</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <span class="keywordflow">if</span> mech != <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            st.subheader(<span class="stringliteral">&quot;Method parameters&quot;</span>)</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#acec58b9300df2360b3d58750578c3b41">  126</a></span>            form = mech.create_form()  <span class="comment"># Generate form for mechanism parameters</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keyword">with</span> col_f:</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        st.subheader(<span class="stringliteral">&#39;Identifiers and Quasi-Identifiers&#39;</span>)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a502a835f2d66f8333d155466130ab260">  130</a></span>        k_value = st.number_input(label=<span class="stringliteral">&#39;k-value&#39;</span>,min_value=1,step=1,value=1)</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#ac2dbba359cb50af9baee7c03416d394d">  131</a></span>        n_threads = st.number_input(label=<span class="stringliteral">&#39;number of threads&#39;</span>,min_value=1,step=1,value=1)</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a1e58eb9ee81947805ef34f70162853ec">  132</a></span>        submit_identify_vuln = st.button(label=<span class="stringliteral">&#39;Identify vulnerabilities&#39;</span>)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        <span class="comment"># submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_identify_vuln submit_vuln_vuln submit_vuln_vuln submit_vuln</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        <span class="keywordflow">if</span> submit_identify_vuln:</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>            <span class="keyword">with</span> src.JPI.JPI() <span class="keyword">as</span> jpi:</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                jpi.identify_vulnerabilities(st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>],k_value,n_threads)</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a377b355280ea532cf712adda873b869c">  137</a></span>                identifiers, quasi_identifiers = <a class="code hl_function" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a0b80f1c6e8300057115176c5fe13592a">get_vuln_cols</a>(vulnerabilities=jpi.vulnerabilities)</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                <span class="keyword">with</span> st.expander(<span class="stringliteral">&quot;Show identifiers&quot;</span>):</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a1d87c5f02bcca8c409426f1dd8bb1af1">  139</a></span>                    df_identifiers = pd.DataFrame({<span class="stringliteral">&#39;Identifiers&#39;</span>: identifiers})</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                    st.write(df_identifiers.T)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                <span class="keyword">with</span> st.expander(<span class="stringliteral">&quot;Show quasi-identifiers&quot;</span>):</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a412a4e3de213f59f4fd8e3328d8d83a2">  142</a></span>                    df_quasi = pd.DataFrame({<span class="stringliteral">&#39;Quasi-Identifiers&#39;</span>: quasi_identifiers})</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                    st.write(df_quasi.T)</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="comment"># Reset column</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    col_a, col_b = st.columns((2, 10))</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keyword">with</span> col_a:</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a874bd7ba8dcf78ff7fba76237246dcfe">  148</a></span>        col_to_reset = st.selectbox(<span class="stringliteral">&quot;Column to reset&quot;</span>, st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>].columns)</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a7a3b7d6e14d98c52adf6d758ac476d99">  150</a></span>    col_c, col_d, col_e = st.columns((1, 5, 1))</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="keyword">with</span> col_c:</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#acc03b562675bff084df56496201cf17c">  152</a></span>        submit_reset = st.button(label=<span class="stringliteral">&#39;Reset column&#39;</span>)</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        <span class="comment"># if submit_reset is true the session_state df_anonymize col_to_reset is set to the current value of the column to reset.</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        <span class="keywordflow">if</span> submit_reset:</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>][col_to_reset] = st.session_state[<span class="stringliteral">&#39;df&#39;</span>][col_to_reset].copy()</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keyword">with</span> col_e:</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a9cbc6ea76f20cd4a74182684ed0eaec1">  157</a></span>        submit_reset_all = st.button(label=<span class="stringliteral">&#39;Reset dataset&#39;</span>, help=<span class="stringliteral">&quot;Reset all columns to original values&quot;</span>)</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        <span class="comment"># if submit_reset_all is true the session_state df_anonymize is set to the session_state df_anonymize and the experimental_rerun is set to the same value as the session_state df_anonymize.</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="keywordflow">if</span> submit_reset_all:</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>] = st.session_state[<span class="stringliteral">&#39;df&#39;</span>].copy()</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            st.experimental_rerun()</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="comment"># Create dataframe grid</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#abc6acc07ceb80df7963b18c4117abdda">  164</a></span>    gb = GridOptionsBuilder.from_dataframe(st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>])</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a5ae271a505b3584d75dfd8f9bbb90f6c">  165</a></span>    gb.configure_pagination(paginationAutoPageSize=<span class="keyword">True</span>)  <span class="comment"># Add pagination</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    gb.configure_side_bar()  <span class="comment"># Add a sidebar</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#ac5262f4438b7cbd5c53749006ca4398e">  167</a></span>    gb.configure_selection(<span class="stringliteral">&#39;multiple&#39;</span>, use_checkbox=<span class="keyword">True</span>,</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a2ef33225360addee83dfd15b5c2f2e2f">  168</a></span>                           groupSelectsChildren=<span class="stringliteral">&quot;Group checkbox select children&quot;</span>)  <span class="comment"># Enable multi-row selection</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a6a7ecc15d59ef57fbb11c99cb2131ba2">  170</a></span>    cellstyle_jscode = JsCode(<span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span><span class="stringliteral">     function(params) {</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="stringliteral">         </span><span class="keywordflow">return</span> {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>             <span class="stringliteral">&#39;backgroundColor&#39;</span>: <span class="stringliteral">&#39;rgb(77, 195, 255, 0.25)&#39;</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>         }</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>     };</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>     <span class="stringliteral">&quot;&quot;&quot;)</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="stringliteral">    </span><span class="comment"># Configures the selected columns in the session state.</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;selected_columns&#39;</span> <span class="keywordflow">in</span> st.session_state:</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="comment"># Configures the cell style of each selected column.</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        <span class="keywordflow">for</span> col <span class="keywordflow">in</span> st.session_state[<span class="stringliteral">&#39;selected_columns&#39;</span>]:</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a67fc39bdac8db764d86c02e93d5bd385">  182</a></span>            gb.configure_column(col, cellStyle=cellstyle_jscode)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#a410c1587d063a7112d5503c84b4b7c26">  184</a></span>    gridOptions = gb.build()</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="namespace6___xF0_x9F_x94_x92___anonymization.html#ae85b95b0604b61dec33c71dd1e75799b">  186</a></span>    grid_response = AgGrid(</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        st.session_state[<span class="stringliteral">&#39;df_anonymize&#39;</span>],</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>        gridOptions=gridOptions,</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        data_return_mode=<span class="stringliteral">&#39;AS_INPUT&#39;</span>,</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        update_mode=<span class="stringliteral">&#39;MODEL_CHANGED&#39;</span>,</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        fit_columns_on_grid_load=<span class="keyword">False</span>,</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        theme=<span class="stringliteral">&#39;alpine&#39;</span>,  <span class="comment"># Add theme color to the table</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        enable_enterprise_modules=<span class="keyword">True</span>,</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        height=600,</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        width=<span class="stringliteral">&#39;100%&#39;</span>,</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        reload_data=<span class="keyword">True</span>,</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        allow_unsafe_jscode=<span class="keyword">True</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    )</div>
<div class="ttc" id="anamespace6___xF0_x9F_x94_x92___anonymization_html_a0b80f1c6e8300057115176c5fe13592a"><div class="ttname"><a href="namespace6___xF0_x9F_x94_x92___anonymization.html#a0b80f1c6e8300057115176c5fe13592a">6_ðŸ”’_Anonymization.get_vuln_cols</a></div><div class="ttdeci">def get_vuln_cols(vulnerabilities)</div><div class="ttdef"><b>Definition:</b> <a href="6___xF0_x9F_x94_x92___anonymization_8py_source.html#l00030">6_ðŸ”’_Anonymization.py:30</a></div></div>
<div class="ttc" id="anamespace6___xF0_x9F_x94_x92___anonymization_html_a69bd3a1894e9de6217d3ce288dec67a8"><div class="ttname"><a href="namespace6___xF0_x9F_x94_x92___anonymization.html#a69bd3a1894e9de6217d3ce288dec67a8">6_ðŸ”’_Anonymization.applyMech</a></div><div class="ttdeci">def applyMech(col_to_anonymize)</div><div class="ttdef"><b>Definition:</b> <a href="6___xF0_x9F_x94_x92___anonymization_8py_source.html#l00015">6_ðŸ”’_Anonymization.py:15</a></div></div>
<div class="ttc" id="anamespace_d_p_mech_factory_html"><div class="ttname"><a href="namespace_d_p_mech_factory.html">DPMechFactory</a></div><div class="ttdef"><b>Definition:</b> <a href="_d_p_mech_factory_8py_source.html#l00001">DPMechFactory.py:1</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>

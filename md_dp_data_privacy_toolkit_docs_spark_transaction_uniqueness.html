<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PolyBM: Invoking the uniqueness calculator Spark executor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="LGS.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">PolyBM<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">The PolyBM Data Analysis Tool is an AI tool that helps users profile, format, and anonymize data from CSV, JSON, and XML files. The tool offers various functionalities such as creating charts, generating data quality reports, and anonymizing sensitive data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_dp_data_privacy_toolkit_docs_spark_transaction_uniqueness.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Invoking the uniqueness calculator Spark executor </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The executor requires the input path as well as the configuration file. It can be invoked as:</p>
<div class="fragment"><div class="line">spark-submit \</div>
<div class="line">    --class com.ibm.research.drl.dpt.spark.risk.TransactionUniqueness \</div>
<div class="line">    dpt-spark-$VERSION-jar-with-dependencies.jar \</div>
<div class="line">    -i test.csv \</div>
<div class="line">    -c uniqueness_configuration.json \</div>
<div class="line">    -o report.jsom</div>
</div><!-- fragment --><p>where <code>uniqueness_configuration.json</code> is the configuration file, <code>test.csv</code> is the input file and <code>report.json</code> is the output filename.</p>
<p>The full list of parameters to the executor are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-i,&ndash;input &lt;arg&gt;   </td><td class="markdownTableBodyNone">Path to the file to be masked (required)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-o,&ndash;output &lt;arg&gt;   </td><td class="markdownTableBodyNone">Output filename for the report (required)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-c,&ndash;conf &lt;arg&gt;   </td><td class="markdownTableBodyNone">Path to the configuration file (required)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">&ndash;remoteConf   </td><td class="markdownTableBodyNone">If set, then the configuration file will be read from HDFS (optional)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">&ndash;remoteOutput   </td><td class="markdownTableBodyNone">If set, then the report file will be saved to HDFS (optional)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-basePath &lt;arg&gt;   </td><td class="markdownTableBodyNone">Specify the base path of the input (optional)   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md255"></a>
Writing the configuration file</h1>
<p>The configuration file has the following structure:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">   &quot;delimiter&quot;: &quot;,&quot;,</div>
<div class="line">   &quot;quoteChar&quot;: &quot;\&quot;&quot;,</div>
<div class="line">   &quot;hasHeader&quot;: true,</div>
<div class="line">   &quot;trimFields&quot;: false,</div>
<div class="line">    </div>
<div class="line">   &quot;inputFormat&quot;: &quot;PARQUET&quot;,</div>
<div class="line"> </div>
<div class="line">    &quot;idColumn&quot;: [&quot;id&quot;],</div>
<div class="line">    &quot;targetColumns&quot;: [&quot;chain&quot;, &quot;date&quot;],</div>
<div class="line">    &quot;factor&quot;: 1,</div>
<div class="line">    &quot;threshold&quot;: 1,</div>
<div class="line">    </div>
<div class="line">    &quot;joinRequired&quot;: false,</div>
<div class="line">    &quot;joinInformation&quot; : {</div>
<div class="line">      &quot;rightTable&quot; : &quot;locations.csv&quot;,</div>
<div class="line">      &quot;rightTableInputFormat&quot;: &quot;CSV&quot;,</div>
<div class="line">      &quot;rightTableDatasetOptions&quot; : {</div>
<div class="line">        &quot;delimiter&quot;: &quot;,&quot;,</div>
<div class="line">        &quot;quoteChar&quot;: &quot;\&quot;&quot;,</div>
<div class="line">        &quot;hasHeader&quot;: true,</div>
<div class="line">        &quot;trimFields&quot;: false</div>
<div class="line">      },</div>
<div class="line">      &quot;rightColumn&quot; : &quot;shop_id&quot;,</div>
<div class="line">      &quot;leftColumn&quot; : &quot;loc_id&quot;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>delimiter</code>, <code>quoteChar</code>, <code>hasHeader</code> and <code>trimFields</code> are CSV-specific options and control the delimiter, quote character, how to treat the first line and if leading and trailing whitespaces should be trimmed from the values respectively</li>
<li><code>inputFormat</code> specifies the input format. Valid options are <code>CSV</code>, <code>JSON</code> and <code>PARQUET</code>.</li>
<li><code>idColumn</code> specifies the column(s) to be used as the primary ID for the dataset.</li>
<li><code>targetColumns</code> defines the columns(s) to be used as the value for each record</li>
<li><code>factor</code> is a placeholder for an upcoming feature and should be set to 1</li>
<li><code>threshold</code> defines the uniqueness threshold. For example, if set to 5, unique transactions will be considered the ones that appear 5 or less times.</li>
<li><code>joinRequired</code> is a boolean value that specifies if we need to join the dataset under examination with another dataset before the analysis begins.</li>
</ul>
<p>If a join is required then the <code>joinInformation</code> object needs to be present. This object must contain the following fields:</p><ul>
<li><code>rightTable</code> which is the location of the table to join with</li>
<li><code>rightTableInputFormat</code> specifies the input format of the <code>rightTable</code></li>
<li><code>rightColumn</code> is the column of the <code>rightTable</code> to join with</li>
<li><code>leftColumn</code> is the column of the dataset under examination to join with</li>
<li><code>rightTableDatasetOptions</code> is an object and includes input format specific options: <code>delimiter</code>, <code>quoteChar</code>, <code>hasHeader</code> and <code>trimFields</code> as specified above</li>
</ul>
<p>The calculation job has also the ability to mask records before calculating the uniqueness metrics. If the user wants to mask the input dataset, then the configuration also needs to include the masking configuration. See masking documentation for more details.</p>
<h1><a class="anchor" id="autotoc_md256"></a>
Output</h1>
<p>The uniqueness job will produce the following output:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;total_ids&quot; : 15281683,</div>
<div class="line">  &quot;total_transactions&quot; : 27145034,</div>
<div class="line">  &quot;unique_ids&quot; : 14974833,</div>
<div class="line">  &quot;unique_transactions&quot; : 25920255</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>total_ids</code> and <code>total_transactions</code> are the distinct IDs and total transactions found in the dataset. The IDs are calculated based on the <code>idColumn</code> input configuration</li>
<li><code>unique_transactions</code> is the number of transactions that appear equal or fewer times than the <code>threshold</code> input configuration value</li>
<li><code>unique_ids</code> are the distinct IDs that correspond to the unique transactions</li>
</ul>
<h1><a class="anchor" id="autotoc_md257"></a>
Errors</h1>
<p>A runtime exception will be thrown at the following cases:</p>
<ul>
<li>misconfiguration in the configuration file (wrong types or values)</li>
<li>the input file cannot be found</li>
<li>the user has no permission to read the input file or write to the output directory </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
